<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305576 (zh-CN, DDL); Windows/6.1.7600 (Win64);"/>
  <meta name="reminder-order" content="2016/12/2 5:02"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1297"/>

<div>
<span><div><span style="font-size: 19px; font-weight: bold;"><br/></span></div><div><span style="font-size: 19px; font-weight: bold;">通信协议是什么？</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">交流的规则</span></div><div><br/></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">举例：</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">汉语、英语、法语、德语</span></div></div><div><br/></div><div><br/></div><div><span style="font-size: 19px;"><span style="font-size: 19px; font-weight: bold;">IP协议 Internet Protocol</span></span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">4个字节, 一共32位</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">子网掩码 的作用？ 255.255.255.0  </span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">确认两台计算机是否处于同一网段</span></div><div><br/></div></div><div><br/></div><div><img src="第09单元_files/Image.png" type="image/png" data-filename="" style="height: auto;"/></div><div><br/></div><div><span style="font-size: 19px; font-weight: bold;">TCP、UDP的区别</span></div><div><span style="font-size: 15px;">如果TCP比作是打电话，那么UDP就是在发短信</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">TCP面向连接的协议（通信之前必须先建立连接）</span></span></div><div><br/></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(166, 0, 196); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">于是，TCP相对可靠，它建立连接的过程称为3次握手</span></span></div><div><br/></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">第一个特点：</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     三次握手，建立连接</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><img src="第09单元_files/Image [1].png" type="image/png" data-filename="" style="height:auto;" width="311"/></span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">     </span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">第二个特点：</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">     <span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-size: 16px; font-weight: bold;">所有的消息，需要对方确认送达。</span></span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">&quot;土豆，土豆，我是茄子，收到请回答&quot;</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(45, 79, 201);">&quot;茄子，茄子，我是土豆，收到消息&quot;</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">     <span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-size: 16px; font-weight: bold;">当消息发送失败，则对当前消息开始进行重复发送，直至收到回应为止。</span></span></span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">&quot;茄子，茄子，我是土豆，我被人油炸了，我改名叫薯片，收到请回答&quot;</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">............</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">&quot;茄子，茄子，我是土豆，我被人油炸了，我改名叫薯片，收到请回答，第2遍&quot;</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">............</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">&quot;茄子，茄子，我是土豆，我被人油炸了，我改名叫薯片，收到请回答，第3遍&quot;</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(255, 0, 0);">............</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(45, 79, 201);">&quot;薯片，薯片，我收到消息&quot;</span></span></div><div><br/></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">    <span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-size: 16px; font-weight: bold;"> 因此可以确保数据的准确送达</span></span></span></div><div><span style="font-size: 12px;"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(166, 0, 196);">举例：</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(166, 0, 196);">局域网游戏，往往都有这样的特点，当多人联机对战时，若有一个人掉线</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(166, 0, 196);">其他所有玩家进入读秒状态，那么说明玩家和玩家之间采用了TCP协议。</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(166, 0, 196);">因为对于游戏来讲，它不允许丢失任何数据，不然有可能出现两边不一致的情况：</span></span></div><div><span style="font-size: 12px;"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(166, 0, 196);">我这边画面一刀把你砍死了，你那边画面却吃了个大血瓶抗住了。。。。。</span></span></div><div><br/></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">UDP面向数据报的协议  (不可靠的协议)</span></span></div><div><br/></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">      <span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-size: 16px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">无需建立连接</span></span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">      <span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-size: 16px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">发送消息也无需对方确认</span></span></span></div><div><span style="font-size: 12px;"><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">      <span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-size: 16px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">无法保证数据的发送顺序，以及准确率</span></span></span></div><div><span style="font-size: 15px;"><span style="background-color: rgb(251, 250, 248); font-size: 15px; color: rgb(255, 0, 0);">数据的发送顺序是 a.........b.........c...........d</span></span></div><div><span style="font-size: 15px;"><span style="background-color: rgb(251, 250, 248); font-size: 15px; color: rgb(255, 0, 0);">由于网路延迟的原因，对方收到数据的顺序有可能是b...........d..........a</span></span></div><div><br/></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); font-weight: bold;">UDP通常用于视频、语音等通信（丢掉了一帧画面是无所谓的）</span></div></div><div><br/></div><div><span style="font-size: 19px;"><span style="font-size: 19px; font-weight: bold;">HTTP（无状态的协议）  </span></span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">基于TCP协议的一种高级协议,  用于客户端和服务器直接的通信</span></div><div><br/></div></div><div><br/></div><div><span style="font-size: 19px;"><span style="font-size: 19px; font-weight: bold;">Socket</span></span></div><div><span style="font-size: 15px;">(socket是一种网路通信模型，由伯克利大学发明，由于其优秀的设计后被各大编程语言所采用)</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(166, 0, 196); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//以下是JAVA使用socket链接百度服务器，请求首页的代码</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">import java.io.BufferedReader;</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">import java.io.BufferedWriter;</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">import java.io.InputStreamReader;</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">import java.io.OutputStreamWriter;</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">import java.net.Socket;</span></div><div><br/></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">public class ClientSocket {</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">    public static void main(String[] args) throws Exception {</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        Socket skt = new Socket(&quot;61.135.169.125&quot;,80);</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        BufferedWriter bw =  new BufferedWriter( new OutputStreamWriter( skt.getOutputStream() ) );</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.write(&quot;GET / HTTP/1.1&quot;);</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.newLine();</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.write(&quot;Host: www.baidu.com:80&quot;);</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.newLine();</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.write(&quot;Content-Type: text/html&quot;);</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.newLine();</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.newLine();</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        bw.flush();</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        //GET / HTTP/1.1</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        //Host: localhost:8080</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        //Content-Type: text/html</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        BufferedReader br = new BufferedReader(new InputStreamReader(skt.getInputStream()));</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        String str = null;</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        while( (str = br.readLine()) != null) {</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">              System.out.println(str);</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">        }</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">    }</span></div><div><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">}</span></div><div><br/></div></div><div><br/></div><div><span style="font-size: 15px;">反复观察上面这个SOCKET程序的运行结果，你能看的出来么？这种通信最大的问题在哪？</span></div><div><span style="font-size: 15px;">问题就在于每次收到返回的页面，连接都断开了。</span></div><div><br/></div><div><span style="font-size: 15px;">因此HTTP这种无状态的协议，最大的特点就是，你挂断了电话老子还怎么通讯？！</span></div><div><span style="font-size: 15px;">刚刚提交过的用户名密码(登录动作)，</span></div><div><span style="font-size: 15px;">下次请求服务器(例如查询账户余额)，难道还要重新验证身份？</span></div><div><br/></div><div><span style="font-size: 15px;">于是cookie就出现了</span></div><div><br/></div><div><span style="font-size: 19px;"><span style="font-size: 19px; font-weight: bold;">COOKIE的诞生，为什么叫<font style="color: rgb(255, 0, 0);">会话跟踪技术</font>？</span></span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">在一次会话从开始到结束的整个过程，全程跟踪记录客户端的状态（例如：是否登录、购物车信息、是否已下载、是否已点赞、视频播放进度等等）</span></div></div><div><br/></div><div><span style="font-size: 15px; color: rgb(166, 0, 196);">你把COOKIE就当成是第一次跟服务器连接后，服务器发给你的身份牌，上面就记录跟你有关的信息</span></div><div><span style="font-size: 15px; color: rgb(166, 0, 196);">以后只要再跟服务器通信，必须带着这个身份牌</span></div><div><span style="font-size: 15px; color: rgb(166, 0, 196);">这样一来，关于你是谁？ 有没有登陆过？ 购物车里有什么信息？ 服务器当然就很容易知道了。</span></div><div><span style="font-size: 15px;">     </span></div><div><span style="font-size: 15px;">这里面当然还有很多的安全隐患，也有相应的解决办法，这个不在我们今天的讨论范围。</span></div><div><br/></div><div><span style="font-size: 19px; font-weight: bold;">cookie有哪些特点？</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">1 只能使用文本文件</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(50, 135, 18);">     (如果浏览器可以随意在客户端机器上生成文件，比如身份牌是个定时炸弹，安全问题将会变得非常严重)</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">2 文件有大小限制  4KB</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">     <span style="background-color: rgb(251, 250, 248); color: rgb(50, 135, 18); font-size: 16px;">(文件若没有大小限制，比如身份牌的重量是140斤，挂脖子能不能累死？)</span></span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">3 数量限制</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(51, 51, 51);">     </span><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">（一般浏览器，限制大概在50条左右，你家的门禁卡里能存的下一部蓝光高清么？</span></span><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">）</span></span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">4 读取有域名限制(同源策略)</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">     不可跨域读取，只能由来自 写入cookie的 同一域名 的网页可进行读取。</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">     简单的讲就是，谁写的cookie，谁才有权利读取</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(51, 51, 51);">     <span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">（身份牌是我发你的，当然只有我能读取，你媳妇儿的手机自动连接了邻居老王家的wifi，你知道这意味着什么吗？)</span></span></span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">5 时效限制</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">     每个cookie都有时效，最短的有效期是，会话级别：</span><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">就是当浏览器关闭，那么cookie立即销毁</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(51, 51, 51);">     <span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">（安全学基本理论：密码锁每次打开都需要重新输入密码，输入一次密码，以后就不再验证，就没有安全可言</span></span></span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">          问： 信用卡为什么会有过期时间？     </span></span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">     ）</span></span></div></div><div><br/></div><div><span style="font-size: 19px; font-weight: bold;">Cookie的流程图</span></div><div><img src="第09单元_files/cookie.png" type="image/png" data-filename="cookie.png" style="height: auto;"/></div><div><hr/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;">如果有时候，我们需要这个网页长时间跟服务器保持连接，比如说即时通讯、语音、视频等等</span></div><div><br/></div><div><span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold;">HTML5的websocket，试图解决这个问题</span></span></div><div><br/></div><div><span style="font-size: 16px;">在websocket没有诞生以来，解决这个问题是极为困难的。</span></div><div><br/></div><div><span style="font-size: 16px;">通常有两种做法：ajax轮询和 comet技术</span></div><div><br/></div><div><span style="font-size: 16px; color: rgb(255, 0, 0);">第一种：ajax轮询</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);">就是隔一段时间发一次请求，不停的向服务器询问，有没有新消息</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);">参考咱们的课堂案例，groupchat.html</span></div><div><br/></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);"><img src="第09单元_files/Image [2].png" type="image/png" data-filename="" style="height: auto;"/></span></div><div><br/></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">就是要不停的问！（你有没有考虑过服务器的感受？）</span></div></div><div><br/></div><div><span style="font-size: 16px; color: rgb(255, 0, 0);">第二种 ： comet技术</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">这个是利用了HTTP协议的1.1版本中新推出的长连接</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">咦？这名字听上去好像不错，如果连接可以长时间保持不断开，那问题不就解决了吗？</span></div><div><br/></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">其实长连接仅仅只是延长了连接时间，可以在一次连接中出现很多个request和response</span></div><div><span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">但是在即时通讯这样的功能里面，由于客户端不知道消息何时发过来？</span></div><div><span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">我们需要服务器主动的向客户端推送消息。但长连接并不能做到这一点。</span></div><div><br/></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(51, 51, 51);">因为在HTPP协议的特点中，服务器的response必须是在收到了客户的request后才能产生的</span></span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-weight: bold; font-size: 16px; color: rgb(51, 51, 51);">说白了，你请求一次，服务器返回一次，你不请求，服务器不能主动返回</span></span></div><div><br/></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51);">于是，高手们想到了这样一个办法</span></div><div><span style="background-color: rgb(251, 250, 248);"><img src="第09单元_files/Image [3].png" type="image/png" data-filename="" style="height: auto;"/></span></div><div><br/></div><div><br/></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(255, 0, 0);">&quot;有新消息吗？ 不！我不听！不要告诉我没有！等有新消息了你再回答我！&quot;</span>   //第一次requrest，长连接已经开始</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">............过了一会</span></span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(54, 101, 238);">&quot;有新消息了&quot;</span> //服务器返回，第一次response</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(255, 0, 0);">&quot;哈哈哈，好兴奋&quot;</span>//客户端接收结果并处理，此时连接没有断开</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(255, 0, 0);">&quot;还有新消息吗？等有新消息了再回答我吧！&quot;</span> //第二次requrest</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">............过了一会</span></span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(54, 101, 238);">&quot;有新消息了&quot;</span> //服务器再次返回，第二次response</span></div><div><br/></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);">这样做看起来，好像是服务器主动发送了消息，其实每次我们都要先发请求，只不过没有消息的时候这个请求被阻塞了而已</span></div><div><span style="font-size: 16px; background-color: rgb(251, 250, 248);">不好的地方在于，它消耗了大量程序资源，程序除了处理业务逻辑，还要负责管理这个请求</span></div><div><br/></div><div><br/></div></div><div><br/></div><div><span style="font-size: 16px;">WebSokcet是一种HTTP1.1协议的增强版，就像socket程序一样，消息可以随时发送，随时接受</span></div><div><br/></div><div><span style="font-size: 16px;">我们的服务器从被动的返回，变成了主动的发送</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 16px; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0);">&quot;有新消息吗？有了通知我&quot; </span> <span style="font-size: 16px; background-color: rgb(251, 250, 248);">//第1次requrest，连接上了</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">............过了一会</span></span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(54, 101, 238);">&quot;有新消息了&quot;</span></span> <span style="font-size: 16px; background-color: rgb(251, 250, 248);">//</span><span style="font-size: 16px; background-color: rgb(251, 250, 248);">第1次response，连接保持中...</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">............过了一会</span></span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(54, 101, 238);">&quot;又有新消息了&quot;  </span></span><span style="font-size: 16px; background-color: rgb(251, 250, 248);">//</span><span style="font-size: 16px; background-color: rgb(251, 250, 248);">第2次response，</span><span style="font-size: 16px; background-color: rgb(251, 250, 248);">连接保持中...</span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(50, 135, 18);">............又过了一会</span></span></div><div><span style="font-size: 16px;"><span style="background-color: rgb(251, 250, 248); font-size: 16px; color: rgb(54, 101, 238);">&quot;又有新消息了&quot;  </span></span><span style="font-size: 16px; background-color: rgb(251, 250, 248);">//</span><span style="font-size: 16px; background-color: rgb(251, 250, 248);">第3次response，</span><span style="font-size: 16px; background-color: rgb(251, 250, 248);">连接保持中...</span></div></div><div><br/></div><div><span style="font-size: 16px;">它还有一个巨大的好处就是，</span><span style="font-size: 16px;">这个连接的保持可以不再由程序处理</span></div><div><span style="font-size: 16px; font-weight: bold;">想象这样一个场景：</span></div><div><span style="font-size: 16px;">Twitter上有成千上万的用户，每秒钟有几十万人同时跟服务器做连接，做信息交换。程序能处理的了这么多的连接么？</span></div><div><br/></div><div><span style="font-size: 16px; font-weight: bold;">于是我们考虑这样一种模型：</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><br/></div><div><span style="background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"><img src="第09单元_files/Image [4].png" type="image/png" data-filename="" style="height:auto;" width="815"/></span></div><div><br/></div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 